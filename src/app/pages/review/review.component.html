<div id="nvipContent" class="nvip-content-container col-12">
    <div class="nvip-loading-bar col-12">
        <div class="nvip-loading-bar-text-ctn">
            <fa-icon [icon]="faSpinner" animation="spin" size="3x" [fixedWidth]="true" [ngStyle]="{ color: 'white'}"></fa-icon>
            <span>Loading search results...</span>
        </div>
    </div>
    <div class="nvip-search-form-ctn">
        <form novalidate class="nvip-search-form col-12" #form="ngForm" (ngSubmit)="updateVuln($event, form, vuln)">
            <div class="nvip-form-horizontal-block">
                <c-container>
                    <c-row>
                        <c-col>
                            <div class="nvip-form-field" style="min-width: 300px;">
                                <label for="desc">Description: </label>
                                <textarea if="desc" name="desc" style="width: 90%;" descriptionArea="" rows="8" [(ngModel)]="update.desc"></textarea>
                            </div>
                        </c-col>
                    </c-row>
                </c-container>
            </div>
            <div [hidden]="vuln.cvssScoreList.length == 0" *ngIf="vuln.cvssScoreList !== undefined">
                <button type="button" class="daily-vuln-dropdown-button col-12" (click)="toggleCVSS($event)">CVSSs</button>
                <div class="daily-vuln-content" [ngStyle]="{'max-height': (cvssactive ? '2000px' : '0')}">
                    <div class="nvip-form-horizontal-block" *ngFor="let cvss of vuln.cvssScoreList; let cindex = index">
                        <c-container>
                            <c-row>
                                <c-col>
                                    <div class="nvip-form-field nvip-radio">
                                        <label for="cvss">CVSS: </label>
                                        <input id="cvss" name="cvss" [(ngModel)]="update.cvss[cindex].base_score" placeholder="">
                                        <div >
                                            <label>LOW </label> 
                                            <input type="radio" class="cvssRadios" id="severityLow" name="cvssSeverityId" value="5" [(ngModel)]="update.cvss[cindex].base_score"> 
                                            <label>MEDIUM </label>
                                            <input type="radio" class="cvssRadios" id="severityMedium" name="cvssSeverityId" value="2" [(ngModel)]="update.cvss[cindex].base_score"> 
                                            <label>HIGH </label> 
                                            <input type="radio" class="cvssRadios" id="severityHigh" name="cvssSeverityId" value="1" [(ngModel)]="update.cvss[cindex].base_score"> 
                                            <label>CRITICAL</label> 
                                            <input type="radio" class="cvssRadios" id="severityCritical" name="cvssSeverityId" value="4" [(ngModel)]="update.cvss[cindex].base_score"> 
                                            <label>N/A</label>
                                            <input type="radio" class="cvssRadios" id="severityNA" name="cvssSeverityId" value="3" [(ngModel)]="update.cvss[cindex].base_score">
                                        </div>
                                    </div>
                                </c-col>
                                <c-col>
                                    <div class="nvip-form-field">
                                        <label for="impact">Impact Score: </label>
                                        <input id="impact" name="impact" [(ngModel)]="update.cvss[cindex].impact_score" placeholder="">
                                    </div>
                                </c-col>
                            </c-row>
                        </c-container>
                    </div>
                </div>
            </div>
            <div [hidden]="vuln.vdoList.length == 0" *ngIf="vuln.vdoList !== undefined">
                <button type="button" class="daily-vuln-dropdown-button col-12" (click)="toggleVDO($event)">VDOs</button>
                <div class="daily-vuln-content" [ngStyle]="{'max-height': (vdoactive ? '2000px' : '0')}">
                    <div class="nvip-form-horizontal-block" *ngFor="let vdo of vuln.vdoList; let vindex = index;">
                        <c-container>
                            <c-row>
                                <c-col>
                                    <div class="nvip-form-field">
                                        <label for="label">VDO Label: </label>
                                        <input id="label" list="labeltypes" [(ngModel)]="update.vdos[vindex].vdolabel" [ngModelOptions]="{standalone: true}">
                                        <datalist id="labeltypes">
                                            <option value="MAN_IN_THE_MIDDLE">
                                            <option value="CHANNEL">
                                            <option value="AUTHENTICATION_BYPASS">
                                            <option value="PHYSICAL_HARDWARE">
                                            <option value="APPLICATION">
                                            <option value="HOST_OS">
                                            <option value="FIRMWARE">
                                            <option value="CODE_EXECUTION">
                                            <option value="CONTEXT_ESCAPE">
                                            <option value="GUEST_OS">
                                            <option value="HYPERVISOR">
                                            <option value="SANDBOXED">
                                            <option value="PHYSICAL_SECURITY">
                                            <option value="ASLR">
                                            <option value="LIMITED_RMT">
                                            <option value="LOCAL">
                                            <option value="READ">
                                            <option value="RESOURCE_REMOVAL">
                                            <option value="HPKP/HSTS">
                                            <option value="MULTIFACTOR_AUTHENTICATION">
                                            <option value="REMOTE">
                                            <option value="WRITE">
                                            <option value="INDIRECT_DISCLOSURE">
                                            <option value="SERVICE_INTERRUPT">
                                            <option value="PRIVILEGE_ESCALATION">
                                            <option value="PHYSICAL">
                                        </datalist>
                                    </div>
                                </c-col>
                                <c-col>
                                    <div class="nvip-form-field">
                                        <label for="group">VDO Group: </label>
                                        <input id="group" list="grouptypes" [(ngModel)]="update.vdos[vindex].vdogroup" [ngModelOptions]="{standalone: true}">
                                        <datalist id="grouptypes">
                                            <option value="IMPACT_METHOD">
                                            <option value="CONTEXT">
                                            <option value="MITIGATION">
                                            <option value="ATTACK_THEATER">
                                            <option value="LOGICAL_IMPACT">
                                        </datalist>
                                    </div>
                                </c-col>
                                <c-col>
                                    <div class="nvip-form-field">
                                        <label for="conf">VDO Confidence: </label>
                                        <input id="conf" [(ngModel)]="update.vdos[vindex].confidence" [ngModelOptions]="{standalone: true}">
                                    </div>
                                </c-col>
                            </c-row>
                        </c-container>
                    </div>
                </div>
            </div>
            <div [hidden]="vuln.cpes.length == 0" *ngIf="vuln.cpes !== undefined">
                <button type="button" class="daily-vuln-dropdown-button col-12" (click)="toggleAffProd($event)">Affected Releases</button>
                <div class="daily-vuln-content" [ngStyle]="{'max-height': (aractive ? '2000px' : '0')}">
                    <div class="nvip-form-horizontal-block" *ngFor="let affrel of update.affprods; let aindex = index;">
                        <div class="nvip-form-field col-6" style="overflow: auto;">
                            {{affrel.cpe}}
                        </div>
                        <div class="nvip-form-field col-6">
                            <button type="button" (click)="removeCPE(aindex, vuln)">Delete</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="nvip-form-btn-ctn col-12">
                <button class="nvip-button nvip-form-btn col-3"><span>Update</span></button>
            </div>
        </form>
    </div>
</div>






<!-- <div id="nvipContent" class="nvip-content-container col-12">
    <div class="nvip-loading-bar col-12">
        <div class="nvip-loading-bar-text-ctn">
            <fa-icon [icon]="faSpinner" animation="spin" size="3x" [fixedWidth]="true" [ngStyle]="{ color: 'white'}"></fa-icon>
            <span>Loading search results...</span>
        </div>
    </div>
    <div class="nvip-search-form-ctn" [hidden]="!showForm">
        <form novalidate class="nvip-search-form col-12" #form="ngForm" (ngSubmit)="detailSearchId($event, form)">
            <div class="nvip-form-horizontal-block">
                <c-container>
                    <c-row>
                        <c-col>
                            <div class="nvip-form-field col-6">
                                <label for="cveid">CVE ID: </label>
                                <input id="cveid" name="cveid" [(ngModel)]="review.cveId" placeholder="">
                            </div>
                        </c-col>
                        <c-col>
                            <div class="nvip-form-field col-6">
                                <label for="searchDate">Date</label>
                                <input [ngModel]="review.searchDate | date:'yyyy-MM-dd'" (ngModelChange)="review.searchDate = $event" type="date" name="searchDate" ng-required ="true"/>
                            </div>  
                        </c-col>
                    </c-row>
                </c-container>
            </div>
            <div class="nvip-form-dropdown-field col-12 dropdown-opened" (click)="toggleContent($event, 'Status')">
                <div class="nvip-form-dropdown-left col-11">
                    <label>CVE Status:</label>
                </div>
                <div class="nvip-form-dropdown-right col-1">
                    <fa-icon [icon]="faAngleDown" transform="rotate-{{rotationAmountStatus}}" class="nvip-form-dropdown-caret" aria-hidden="true"></fa-icon>
                </div>
            </div>
            <div class="nvip-form-dropdown-content col-11" style="display: flex;">
                <div *ngFor="let status of statuses" class="nvip-form-field col-4">
                    <div class="nvip-form-field-block col-11">
                        <label for="{{status}}">{{status}}</label>
                        <input type="checkbox" (change)="onStatusChange($event, status)" />        
                    </div>
                </div>
            </div>
            <div class="nvip-form-btn-ctn col-12">
                <button class="nvip-button nvip-form-btn col-3"><span>Search</span></button>
            </div>
        </form>
    </div>
    <div class="nvip-search-result-ctn" [hidden]="showForm">
        <div class="nvip-search-top-ctn col-12">
        </div>
        <div class="nvip-search-page-ctn">
            <div class="nvip-search-result-count col-12">
                <p>{{resultTotalCount}} records found</p>
            </div>
            <div class="nvip-paging-index col-12">
                <p>Showing records {{pageRecord[0]}} to {{pageRecord[1]}}</p>
            </div>
            <div class="nvip-paging-bar-ctn" [hidden]="reviewResults.length <= 10">
                <div class="nvip-paging-bar" (click)="changePage(0)" [hidden]="currentPage == 0">
                    <a>First</a>
                </div>
                <div class="nvip-paging-bar nvip-next-page" (click)="changePage(currentPage - 1)">
                    <a>
                        <fa-icon [icon]="faAngleDoubleLeft" size="lg" aria-hidden="true"></fa-icon>
                    </a>
                </div>
                <div class="nvip-paging-bar" *ngFor="let pageIndex of pageBlocks" (click)="changePage(pageIndex)"
                [ngClass]="{'current-page': pageIndex == currentPage}">
                    <a>{{pageIndex + 1}}</a>
                </div>
                <div class="nvip-paging-bar nvip-next-page" (click)="changePage(currentPage + 1)">
                    <a>
                        <fa-icon [icon]="faAngleDoubleRight" size="lg" aria-hidden="true"></fa-icon>
                    </a>
                </div>
                <div class="nvip-paging-bar" (click)="changePage(totalPages - 1)" [hidden]="currentPage >= (totalPages - 1)">
                    <a>Last</a>
                </div>
            </div>
            <div class="nvip-search-result-page col-10">
                <p class="nvip-cve-panel-empty" [hidden]="reviewResults.length > 0">No CVEs identified</p>
                <div class="nvip-search-result col-12" *ngFor="let vuln of filteredReviewResults; let index = index;" [hidden]="reviewResults.length == 0">
                    <button type="button" class="daily-vuln-dropdown-button col-12" (click)="selectReviewCve($event, vuln, index)">
                            <div class="daily-vuln-dropdown-row">
                                <div class="daily-vuln-dropdown-row-1">
                                    <span class="nvip-cve-number-span" id="cve_id">{{vuln.cve_id}}</span>
                                    <span class="nvip-cve-number-span" id="status">Status: {{statusIdToString(vuln.status_id)}}</span>
                                </div>
                            </div>
                    </button>
                        <div class="daily-vuln-content" [ngStyle]="{'max-height': (vuln.active ? '2000px' : '0')}">
                            <form novalidate class="nvip-search-form col-12" (ngSubmit)="updateVuln($event, form, vuln)">
                                
                                <div class="nvip-form-horizontal-block">
                                    <div class="nvip-form-field col-6">
                                        <label for="info">Comment: </label>
                                        <input if="info" name="info" [(ngModel)]="update.info" placeholder="">
                                    </div>
                                </div>
                                <div class="nvip-form-btn-ctn col-12">
                                    <button class="nvip-button nvip-form-btn col-3"><span>Update</span></button>
                                </div>
                            </form>
                        </div>
                </div>
            </div>
        </div>
    </div>
</div> -->

<!-- <div class="nvip-search-result-header col-12">
    <p ng-show="showForm">Review Form</p>
</div>

<div style="width: 100%;">
    <div style="float: left; padding-left: 10px; width: 35%;">
        <label id="cveIDLabel">currentCVEid</label> 

        <label>Selected: selected.cve_id</label><br>
        <label>CVE Status: review.readableStatus </label> <br>
        <label>Edited by: cveDetails.userFname cveDetails.userLname (userName) at updateDate</label>
        
        <div>
            <button ng-click="prevCVE()">Previous CVE</button>
            <button ng-click="nextCVE()">Next CVE</button>
        </div>

        <textarea style="width: 100%;" descriptionArea rows="25" ng-model="review.currentCVEdesc"></textarea>
        
        <div id="detailsProgressCircle" style="width: 100%;  height: 100%;  position: absolute;  top: 50%;  left: 40%; display:none;">
            <fa-icon [icon]="faSpinner" animation="spin" size="3x" [fixedWidth]="true" [ngStyle]="{ color: 'black'}"></fa-icon>
            <span>Loading...</span>
        </div>

        <div class="nvip-form-field">
            <button id="btnAccept" ng-click="acceptCVE()">Accept</button>
            <button id="btnUpdate" ng-click="updateButton()">Update</button>
            <button id="btnReject" ng-click="rejectCVE()">Reject</button>
            <div style="display: inline; margin-left: 20px">
                <input type="checkbox" id="chTweet" name="tweet" checked>
                <label for="chTweet"> Tweet CVE upon accept</label>
            </div>
            <button style="float:right;" ng-click="updateDailyVulns()">Update<br/>Daily CVE Table</button>
        </div>

        <div class="nvip-message">
            <p class="message-text" id="nvip_message_text">reviewMessage</p>
        </div>

    </div>
    <div style="float: left; padding-left: 10px; padding-right: 10px; padding-bottom: 20px; width: 50%;">
        
        <div style="float: left; padding-left: 10px; padding-right: 10px; width: 50%;">
            <label>Impact Method:</label><br>
            <div class="review-unchecked-vdo" ng-repeat="item in impctList" id="divitem">
                <input type="checkbox" id="chitem" name="item" ng-click="manualCheck(item)"> 
                <label> item : </label> 
                <input type="radio" id="highitem" name="confidenceitem" ng-click="enableRBgroup(item,1)" checked disabled> 
                <label for="highitem"> High </label> 
                <input type="radio" id="mediumitem" name="confidenceitem" ng-click="enableRBgroup(item,0.66)" disabled> 
                <label for="mediumitem"> Medium </label>
                <input type="radio" id="lowitem" name="confidenceitem" ng-click="enableRBgroup(item,0.33)" disabled>
                <label for="lowitem"> Low </label><br>
            </div>
        </div>
        <div style="float: left; padding-left: 10px; padding-right: 10px; width: 50%;">
            <label>Mitigation:</label><br>
            <div class="review-unchecked-vdo" ng-repeat="item in mitigationList" id="divitem">
                <input type="checkbox" id="chitem" name="item" ng-click="manualCheck(item)"> 
                <label> item : </label> 
                <input type="radio" id="highitem" name="confidenceitem" ng-click="enableRBgroup(item,1)" checked disabled> 
                <label for="highitem"> High </label> 
                <input type="radio" id="mediumitem" name="confidenceitem" ng-click="enableRBgroup(item,0.66)" disabled> 
                <label for="mediumitem"> Medium </label>
                <input type="radio" id="lowitem" name="confidenceitem" ng-click="enableRBgroup(item,0.33)" disabled>
                <label for="lowitem"> Low </label><br>
            </div>
        </div>
    </div>
    <div style="float: left; padding-left: 10px; padding-right: 10px; padding-bottom: 20px; width: 50%;">
        <div style="float: left; padding-left: 10px; padding-right: 10px; width: 50%;">
            <label>Context:</label><br>
            <div class="review-unchecked-vdo" ng-repeat="item in ctxList" id="divitem">
                <input type="checkbox" id="chitem" name="item" ng-click="manualCheck(item)"> 
                <label> item : </label> 
                <input type="radio" id="highitem" name="confidenceitem" ng-click="enableRBgroup(item,1)" checked disabled> 
                <label for="highitem"> High </label> 
                <input type="radio" id="mediumitem" name="confidenceitem" ng-click="enableRBgroup(item,0.66)" disabled> 
                <label for="mediumitem"> Medium </label>
                <input type="radio" id="lowitem" name="confidenceitem" ng-click="enableRBgroup(item,0.33)" disabled>
                <label for="lowitem"> Low </label><br>
            </div>
        </div>
        
        <div style="float: left; padding-left: 10px; padding-right: 10px; width: 50%;">
            <label>Logical Impact:</label><br>
            <div class="review-unchecked-vdo" ng-repeat="item in lgclImpctList" id="divitem">
                <input type="checkbox" id="chitem" name="item" ng-click="manualCheck(item)"> 
                <label> item : </label> 
                <input type="radio" id="highitem" name="confidenceitem" ng-click="enableRBgroup(item,1)" checked disabled> 
                <label for="highitem"> High </label> 
                <input type="radio" id="mediumitem" name="confidenceitem" ng-click="enableRBgroup(item,0.66)" disabled> 
                <label for="mediumitem"> Medium </label>
                <input type="radio" id="lowitem" name="confidenceitem" ng-click="enableRBgroup(item,0.33)" disabled>
                <label for="lowitem"> Low </label><br>
            </div>
        </div>
    </div>
    <div style="float: left; padding-left: 10px; padding-right: 10px; width: 50%;">
        <div style="float: left; padding-left: 10px; padding-right: 10px; width: 50%;">
            <label>Attack Theater:</label><br>
            <div class="review-unchecked-vdo" ng-repeat="item in attckThtrList" id="divitem">
                <input type="checkbox" id="chitem" name="item" ng-click="manualCheck(item)"> 
                <label> item : </label> 
                <input type="radio" id="highitem" name="confidenceitem" ng-click="enableRBgroup(item,1)" checked disabled> 
                <label for="highitem"> High </label> 
                <input type="radio" id="mediumitem" name="confidenceitem" ng-click="enableRBgroup(item,0.66)" disabled> 
                <label for="mediumitem"> Medium </label>
                <input type="radio" id="lowitem" name="confidenceitem" ng-click="enableRBgroup(item,0.33)" disabled>
                <label for="lowitem"> Low </label><br>
            </div>
        </div>
        
        <div style="float: left; padding-left: 10px; padding-right: 10px; width: 50%;">
            <label>CVSS Score:</label><br>
            
            <label>Severity:</label>
            <div id="severityClassRBgroup">
                <input type="radio" id="severiryLow" name="CVSSseverity" ng-click="setCVSSseverity('LOW')" > 
                <label>LOW </label> 
                <input type="radio" id="severiryMedium" name="CVSSseverity" ng-click="setCVSSseverity('MEDIUM')" > 
                <label>MEDIUM </label> 
                <input type="radio" id="severiryHigh" name="CVSSseverity" ng-click="setCVSSseverity('HIGH')" > 
                <label>HIGH </label> 
                <input type="radio" id="severiryCritical" name="CVSSseverity" ng-click="setCVSSseverity('CRITICAL')" > 
                <label>CRITICAL</label> 
            </div>
            
            <div>
            <label>Impact Score:</label>
            <input type="number" size="3" min="0" max="10" step="0.1"
                ng-model="review.impactScore">
            </div>
            
            
            
            <label>CPE Items:</label>
            <div ng-repeat="product in cveDetails.vulnDomain">
                <input type="checkbox" id="chProductproduct.product_id" name="product.cpe"> 
                <label>Remove: </label>
                <a style="color:black;"  href="https://nvd.nist.gov/products/cpe/search/results?namingFormat=2.3&keyword=product.cpe" target="_blank">product.cpe</a>
                
            </div>
        </div>
    </div>
</div> -->