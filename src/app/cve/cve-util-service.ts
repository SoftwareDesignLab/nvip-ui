import { Injectable } from "@angular/core";
import { Search } from "./models/utils.model";


export interface tabInfo {
    icon: string;
    title: string;
}

export class Pagination{
    currentPage:number=1;
    totalPages:number=0;
    
}
@Injectable({
    providedIn: "root",
})
export class CveUtilService {
    paginationObject:Pagination=new Pagination();
    vulnerabilities:any[]=[];

    tabs: tabInfo[] = [
        {
            icon: 'fa fa-info-circle',
            title: 'Description',
        },
        {
            icon: 'fa fa-list',
            title: 'Vulnerability Sources',
        },
        {
            icon: ' fa fa-product-hunt',
            title: 'Affected Products',
        },
        {
            icon: 'fa fa-tag',
            title: 'VDO Labels',
        },
        {
            icon: 'fa fa-signal',
            title: 'SSVC Scores',
        },
        {
            icon: 'fa fa-cogs',
            title: 'Patches',
        },
        {
            icon: 'fa fa-cogs',
            title: 'Fixes',
        },
        {
            icon: 'fa-solid fa-skull-crossbones',
            title: 'Exploits',
        },
        {
            icon: 'fa-solid fa-list',
            title: 'CPE',
        },
    ];

    constructor(){
        this.searchObject=new Search();
    }


    extractSourceName(url: string,alt:string ): string {
        try {
            const parsedUrl = new URL(url);
            return parsedUrl.hostname;
        } catch (e) {
            return alt;
        }
    }
    searchObject:Search=new Search();
}